{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import{disableTextSelection,restoreTextSelection}from\"./textSelection\";import{useMemo,useRef}from'react';import{useGlobalListeners}from'@react-aria/utils';export function useMove(props){var onMoveStart=props.onMoveStart,onMove=props.onMove,onMoveEnd=props.onMoveEnd;var state=useRef({didMove:false,lastPosition:null,id:null});var _useGlobalListeners=useGlobalListeners(),addGlobalListener=_useGlobalListeners.addGlobalListener,removeGlobalListener=_useGlobalListeners.removeGlobalListener;var moveProps=useMemo(function(){var moveProps={};var start=function start(){disableTextSelection();state.current.didMove=false;};var move=function move(pointerType,deltaX,deltaY){if(deltaX===0&&deltaY===0){return;}if(!state.current.didMove){state.current.didMove=true;onMoveStart===null||onMoveStart===void 0?void 0:onMoveStart({type:'movestart',pointerType:pointerType});}onMove({type:'move',pointerType:pointerType,deltaX:deltaX,deltaY:deltaY});};var end=function end(pointerType){restoreTextSelection();if(state.current.didMove){onMoveEnd===null||onMoveEnd===void 0?void 0:onMoveEnd({type:'moveend',pointerType:pointerType});}};if(typeof PointerEvent!=='undefined'){var onMouseMove=function onMouseMove(e){if(e.button===0){move('mouse',e.pageX-state.current.lastPosition.pageX,e.pageY-state.current.lastPosition.pageY);state.current.lastPosition={pageX:e.pageX,pageY:e.pageY};}};var onMouseUp=function onMouseUp(e){if(e.button===0){end('mouse');removeGlobalListener(window,'mousemove',onMouseMove,false);removeGlobalListener(window,'mouseup',onMouseUp,false);}};moveProps.onMouseDown=function(e){if(e.button===0){start();e.stopPropagation();e.preventDefault();state.current.lastPosition={pageX:e.pageX,pageY:e.pageY};addGlobalListener(window,'mousemove',onMouseMove,false);addGlobalListener(window,'mouseup',onMouseUp,false);}};var onTouchMove=function onTouchMove(e){var touch=_toConsumableArray(e.changedTouches).findIndex(function(_ref){var identifier=_ref.identifier;return identifier===state.current.id;});if(touch>=0){var _e$changedTouches$tou=e.changedTouches[touch],pageX=_e$changedTouches$tou.pageX,pageY=_e$changedTouches$tou.pageY;move('touch',pageX-state.current.lastPosition.pageX,pageY-state.current.lastPosition.pageY);state.current.lastPosition={pageX:pageX,pageY:pageY};}};var onTouchEnd=function onTouchEnd(e){var touch=_toConsumableArray(e.changedTouches).findIndex(function(_ref2){var identifier=_ref2.identifier;return identifier===state.current.id;});if(touch>=0){end('touch');state.current.id=null;removeGlobalListener(window,'touchmove',onTouchMove);removeGlobalListener(window,'touchend',onTouchEnd);removeGlobalListener(window,'touchcancel',onTouchEnd);}};moveProps.onTouchStart=function(e){if(e.changedTouches.length===0||state.current.id!=null){return;}var _e$changedTouches$=e.changedTouches[0],pageX=_e$changedTouches$.pageX,pageY=_e$changedTouches$.pageY,identifier=_e$changedTouches$.identifier;start();e.stopPropagation();e.preventDefault();state.current.lastPosition={pageX:pageX,pageY:pageY};state.current.id=identifier;addGlobalListener(window,'touchmove',onTouchMove,false);addGlobalListener(window,'touchend',onTouchEnd,false);addGlobalListener(window,'touchcancel',onTouchEnd,false);};}var triggerKeyboardMove=function triggerKeyboardMove(deltaX,deltaY){start();move('keyboard',deltaX,deltaY);end('keyboard');};moveProps.onKeyDown=function(e){switch(e.key){case'Left':case'ArrowLeft':e.preventDefault();e.stopPropagation();triggerKeyboardMove(-1,0);break;case'Right':case'ArrowRight':e.preventDefault();e.stopPropagation();triggerKeyboardMove(1,0);break;case'Up':case'ArrowUp':e.preventDefault();e.stopPropagation();triggerKeyboardMove(0,-1);break;case'Down':case'ArrowDown':e.preventDefault();e.stopPropagation();triggerKeyboardMove(0,1);break;}};return moveProps;},[state,onMoveStart,onMove,onMoveEnd,addGlobalListener,removeGlobalListener]);return{moveProps:moveProps};}","map":{"version":3,"mappings":"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","names":["disableTextSelection","restoreTextSelection","useMemo","useRef","useGlobalListeners","useMove","props","onMoveStart","onMove","onMoveEnd","state","didMove","lastPosition","id","addGlobalListener","removeGlobalListener","moveProps","start","current","move","pointerType","deltaX","deltaY","type","end","PointerEvent","onMouseMove","e","button","pageX","pageY","onMouseUp","window","onMouseDown","stopPropagation","preventDefault","onTouchMove","touch","changedTouches","findIndex","identifier","onTouchEnd","onTouchStart","length","triggerKeyboardMove","onKeyDown","key"],"sources":["useMove.web.ts"],"sourcesContent":["/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport { disableTextSelection, restoreTextSelection } from './textSelection';\nimport { MoveEvents, PointerType } from '@react-types/shared';\nimport React, { HTMLAttributes, useMemo, useRef } from 'react';\nimport { useGlobalListeners } from '@react-aria/utils';\n\ninterface MoveResult {\n  /** Props to spread on the target element. */\n  moveProps: HTMLAttributes<HTMLElement>;\n}\n\n/**\n * Handles move interactions across mouse, touch, and keyboard, including dragging with\n * the mouse or touch, and using the arrow keys. Normalizes behavior across browsers and\n * platforms, and ignores emulated mouse events on touch devices.\n */\nexport function useMove(props: MoveEvents): MoveResult {\n  let { onMoveStart, onMove, onMoveEnd } = props;\n\n  let state = useRef<{\n    didMove: boolean;\n    lastPosition: { pageX: number; pageY: number } | null;\n    id: number | null;\n  }>({ didMove: false, lastPosition: null, id: null });\n\n  let { addGlobalListener, removeGlobalListener } = useGlobalListeners();\n\n  let moveProps = useMemo(() => {\n    let moveProps: HTMLAttributes<HTMLElement> = {};\n\n    let start = () => {\n      disableTextSelection();\n      state.current.didMove = false;\n    };\n    let move = (pointerType: PointerType, deltaX: number, deltaY: number) => {\n      if (deltaX === 0 && deltaY === 0) {\n        return;\n      }\n\n      if (!state.current.didMove) {\n        state.current.didMove = true;\n        onMoveStart?.({\n          type: 'movestart',\n          pointerType,\n        });\n      }\n      onMove({\n        type: 'move',\n        pointerType,\n        deltaX: deltaX,\n        deltaY: deltaY,\n      });\n    };\n    let end = (pointerType: PointerType) => {\n      restoreTextSelection();\n      if (state.current.didMove) {\n        onMoveEnd?.({\n          type: 'moveend',\n          pointerType,\n        });\n      }\n    };\n\n    if (typeof PointerEvent !== 'undefined') {\n      let onMouseMove = (e: MouseEvent) => {\n        if (e.button === 0) {\n          move(\n            'mouse',\n            e.pageX - state.current.lastPosition.pageX,\n            e.pageY - state.current.lastPosition.pageY\n          );\n          state.current.lastPosition = { pageX: e.pageX, pageY: e.pageY };\n        }\n      };\n      let onMouseUp = (e: MouseEvent) => {\n        if (e.button === 0) {\n          end('mouse');\n          removeGlobalListener(window, 'mousemove', onMouseMove, false);\n          removeGlobalListener(window, 'mouseup', onMouseUp, false);\n        }\n      };\n      moveProps.onMouseDown = (e: React.MouseEvent) => {\n        if (e.button === 0) {\n          start();\n          e.stopPropagation();\n          e.preventDefault();\n          state.current.lastPosition = { pageX: e.pageX, pageY: e.pageY };\n          addGlobalListener(window, 'mousemove', onMouseMove, false);\n          addGlobalListener(window, 'mouseup', onMouseUp, false);\n        }\n      };\n\n      let onTouchMove = (e: TouchEvent) => {\n        // @ts-ignore\n        let touch = [...e.changedTouches].findIndex(\n          ({ identifier }) => identifier === state.current.id\n        );\n        if (touch >= 0) {\n          let { pageX, pageY } = e.changedTouches[touch];\n          move(\n            'touch',\n            pageX - state.current.lastPosition.pageX,\n            pageY - state.current.lastPosition.pageY\n          );\n          state.current.lastPosition = { pageX, pageY };\n        }\n      };\n      let onTouchEnd = (e: TouchEvent) => {\n        // @ts-ignore\n        let touch = [...e.changedTouches].findIndex(\n          ({ identifier }) => identifier === state.current.id\n        );\n        if (touch >= 0) {\n          end('touch');\n          state.current.id = null;\n          removeGlobalListener(window, 'touchmove', onTouchMove);\n          removeGlobalListener(window, 'touchend', onTouchEnd);\n          removeGlobalListener(window, 'touchcancel', onTouchEnd);\n        }\n      };\n      moveProps.onTouchStart = (e: React.TouchEvent) => {\n        if (e.changedTouches.length === 0 || state.current.id != null) {\n          return;\n        }\n\n        let { pageX, pageY, identifier } = e.changedTouches[0];\n        start();\n        e.stopPropagation();\n        e.preventDefault();\n        state.current.lastPosition = { pageX, pageY };\n        state.current.id = identifier;\n        addGlobalListener(window, 'touchmove', onTouchMove, false);\n        addGlobalListener(window, 'touchend', onTouchEnd, false);\n        addGlobalListener(window, 'touchcancel', onTouchEnd, false);\n      };\n    }\n\n    let triggerKeyboardMove = (deltaX: number, deltaY: number) => {\n      start();\n      move('keyboard', deltaX, deltaY);\n      end('keyboard');\n    };\n\n    moveProps.onKeyDown = (e) => {\n      switch (e.key) {\n        case 'Left':\n        case 'ArrowLeft':\n          e.preventDefault();\n          e.stopPropagation();\n          triggerKeyboardMove(-1, 0);\n          break;\n        case 'Right':\n        case 'ArrowRight':\n          e.preventDefault();\n          e.stopPropagation();\n          triggerKeyboardMove(1, 0);\n          break;\n        case 'Up':\n        case 'ArrowUp':\n          e.preventDefault();\n          e.stopPropagation();\n          triggerKeyboardMove(0, -1);\n          break;\n        case 'Down':\n        case 'ArrowDown':\n          e.preventDefault();\n          e.stopPropagation();\n          triggerKeyboardMove(0, 1);\n          break;\n      }\n    };\n\n    return moveProps;\n  }, [\n    state,\n    onMoveStart,\n    onMove,\n    onMoveEnd,\n    addGlobalListener,\n    removeGlobalListener,\n  ]);\n\n  return { moveProps };\n}\n"]},"metadata":{},"sourceType":"module"}