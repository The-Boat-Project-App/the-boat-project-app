{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";var _excluded=[\"label\",\"children\",\"onClose\",\"onOpen\",\"defaultIsOpen\",\"placement\",\"openDelay\",\"closeDelay\",\"closeOnClick\",\"offset\",\"isDisabled\",\"hasArrow\",\"arrowSize\",\"isOpen\"];function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import{OverlayContainer}from'@react-native-aria/overlays';import React from'react';import{useControllableState,useKeyboardDismissable}from\"../../../hooks\";import{Popper}from\"../Popper\";import{composeEventHandlers,mergeRefs}from\"../../../utils\";import{PresenceTransition}from\"../Transitions\";import Platform from\"react-native-web/dist/exports/Platform\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import{usePropsResolution}from\"../../../hooks\";import Box from\"../../primitives/Box\";import{useId}from'@react-native-aria/utils';import{useHasResponsiveProps}from\"../../../hooks/useHasResponsiveProps\";import{uniqueId}from'lodash';import{ResponsiveQueryContext}from\"../../../utils/useResponsiveQuery/ResponsiveQueryProvider\";export var Tooltip=function Tooltip(_ref3){var label=_ref3.label,children=_ref3.children,onClose=_ref3.onClose,onOpen=_ref3.onOpen,defaultIsOpen=_ref3.defaultIsOpen,placement=_ref3.placement,_ref3$openDelay=_ref3.openDelay,openDelay=_ref3$openDelay===void 0?0:_ref3$openDelay,_ref3$closeDelay=_ref3.closeDelay,closeDelay=_ref3$closeDelay===void 0?0:_ref3$closeDelay,_ref3$closeOnClick=_ref3.closeOnClick,closeOnClick=_ref3$closeOnClick===void 0?true:_ref3$closeOnClick,offset=_ref3.offset,isDisabled=_ref3.isDisabled,hasArrow=_ref3.hasArrow,_ref3$arrowSize=_ref3.arrowSize,arrowSize=_ref3$arrowSize===void 0?12:_ref3$arrowSize,isOpenProp=_ref3.isOpen,props=_objectWithoutProperties(_ref3,_excluded);var _ref,_ref2,_props$backgroundColo;if(hasArrow&&offset===undefined){offset=0;}else{offset=6;}var resolvedProps=usePropsResolution('Tooltip',props);var _useControllableState=useControllableState({value:isOpenProp,defaultValue:defaultIsOpen,onChange:function onChange(value){value?onOpen&&onOpen():onClose&&onClose();}}),_useControllableState2=_slicedToArray(_useControllableState,2),isOpen=_useControllableState2[0],setIsOpen=_useControllableState2[1];var arrowBg=(_ref=(_ref2=(_props$backgroundColo=props.backgroundColor)!==null&&_props$backgroundColo!==void 0?_props$backgroundColo:props.bgColor)!==null&&_ref2!==void 0?_ref2:props.bg)!==null&&_ref!==void 0?_ref:resolvedProps.bg;var targetRef=React.useRef(null);var enterTimeout=React.useRef();var exitTimeout=React.useRef();var tooltipID=uniqueId();var responsiveQueryContext=React.useContext(ResponsiveQueryContext);var disableCSSMediaQueries=responsiveQueryContext.disableCSSMediaQueries;if(!disableCSSMediaQueries){tooltipID=useId();}var openWithDelay=React.useCallback(function(){if(!isDisabled){enterTimeout.current=setTimeout(function(){return setIsOpen(true);},openDelay);}},[isDisabled,setIsOpen,openDelay]);var closeWithDelay=React.useCallback(function(){if(enterTimeout.current){clearTimeout(enterTimeout.current);}exitTimeout.current=setTimeout(function(){return setIsOpen(false);},closeDelay);},[closeDelay,setIsOpen]);React.useEffect(function(){return function(){clearTimeout(enterTimeout.current);clearTimeout(exitTimeout.current);};},[]);var newChildren=children;if(typeof children==='string'){newChildren=React.createElement(Box,null,children);}newChildren=React.cloneElement(newChildren,{'onPress':composeEventHandlers(newChildren.props.onPress,function(){if(closeOnClick){closeWithDelay();}}),'onFocus':composeEventHandlers(newChildren.props.onFocus,openWithDelay),'onBlur':composeEventHandlers(newChildren.props.onBlur,closeWithDelay),'onMouseEnter':composeEventHandlers(newChildren.props.onMouseEnter,openWithDelay),'onMouseLeave':composeEventHandlers(newChildren.props.onMouseLeave,closeWithDelay),'ref':mergeRefs([newChildren.ref,targetRef]),'aria-describedby':isOpen?tooltipID:undefined});useKeyboardDismissable({enabled:isOpen,callback:function callback(){return setIsOpen(false);}});if(useHasResponsiveProps(props)){return null;}return React.createElement(React.Fragment,null,newChildren,isOpen&&React.createElement(OverlayContainer,null,React.createElement(PresenceTransition,{initial:{opacity:0},animate:{opacity:1,transition:{duration:150}},exit:{opacity:0,transition:{duration:100}},visible:isOpen,style:StyleSheet.absoluteFill},React.createElement(Popper,{triggerRef:targetRef,onClose:function onClose(){return setIsOpen(false);},placement:placement,offset:offset},React.createElement(Popper.Content,{isOpen:isOpen},hasArrow&&React.createElement(Popper.Arrow,{borderColor:\"transparent\",backgroundColor:arrowBg,height:arrowSize,width:arrowSize}),React.createElement(Box,_extends({},resolvedProps,{accessibilityRole:Platform.OS==='web'?'tooltip':undefined,nativeID:tooltipID}),label))))));};","map":{"version":3,"mappings":"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","names":["OverlayContainer","React","useControllableState","useKeyboardDismissable","Popper","composeEventHandlers","mergeRefs","PresenceTransition","usePropsResolution","Box","useId","useHasResponsiveProps","uniqueId","ResponsiveQueryContext","Tooltip","label","children","onClose","onOpen","defaultIsOpen","placement","openDelay","closeDelay","closeOnClick","offset","isDisabled","hasArrow","arrowSize","isOpenProp","isOpen","props","undefined","resolvedProps","value","defaultValue","onChange","setIsOpen","arrowBg","backgroundColor","bgColor","bg","targetRef","useRef","enterTimeout","exitTimeout","tooltipID","responsiveQueryContext","useContext","disableCSSMediaQueries","openWithDelay","useCallback","current","setTimeout","closeWithDelay","clearTimeout","useEffect","newChildren","cloneElement","onPress","onFocus","onBlur","onMouseEnter","onMouseLeave","ref","enabled","callback","initial","opacity","animate","transition","duration","exit","visible","style","StyleSheet","absoluteFill","triggerRef","Content","Arrow","borderColor","height","width","accessibilityRole","Platform","OS","nativeID"],"sources":["Tooltip.tsx"],"sourcesContent":["import { OverlayContainer } from '@react-native-aria/overlays';\nimport React from 'react';\nimport { useControllableState, useKeyboardDismissable } from '../../../hooks';\nimport { Popper } from '../Popper';\nimport { composeEventHandlers, mergeRefs } from '../../../utils';\nimport { PresenceTransition } from '../Transitions';\nimport { Platform, StyleSheet } from 'react-native';\nimport { usePropsResolution } from '../../../hooks';\nimport Box from '../../primitives/Box';\nimport type { ITooltipProps } from './types';\nimport { useId } from '@react-native-aria/utils';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\nimport { uniqueId } from 'lodash';\nimport { ResponsiveQueryContext } from '../../../utils/useResponsiveQuery/ResponsiveQueryProvider';\n\nexport const Tooltip = ({\n  label,\n  children,\n  onClose,\n  onOpen,\n  defaultIsOpen,\n  placement,\n  openDelay = 0,\n  closeDelay = 0,\n  closeOnClick = true,\n  offset,\n  isDisabled,\n  hasArrow,\n  arrowSize = 12,\n  isOpen: isOpenProp,\n  ...props\n}: ITooltipProps) => {\n  if (hasArrow && offset === undefined) {\n    offset = 0;\n  } else {\n    offset = 6;\n  }\n\n  const resolvedProps = usePropsResolution('Tooltip', props);\n  const [isOpen, setIsOpen] = useControllableState({\n    value: isOpenProp,\n    defaultValue: defaultIsOpen,\n    onChange: (value) => {\n      value ? onOpen && onOpen() : onClose && onClose();\n    },\n  });\n\n  const arrowBg =\n    props.backgroundColor ?? props.bgColor ?? props.bg ?? resolvedProps.bg;\n\n  const targetRef = React.useRef(null);\n\n  const enterTimeout = React.useRef<any>();\n  const exitTimeout = React.useRef<any>();\n  // const tooltipID = '';\n  // const tooltipID = useId();\n\n  let tooltipID = uniqueId();\n\n  // let id = uniqueId();\n  const responsiveQueryContext = React.useContext(ResponsiveQueryContext);\n  const disableCSSMediaQueries = responsiveQueryContext.disableCSSMediaQueries;\n\n  if (!disableCSSMediaQueries) {\n    // This if statement technically breaks the rules of hooks, but is safe\n    // because the condition never changes after mounting.\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    tooltipID = useId();\n  }\n\n  const openWithDelay = React.useCallback(() => {\n    if (!isDisabled) {\n      enterTimeout.current = setTimeout(() => setIsOpen(true), openDelay);\n    }\n  }, [isDisabled, setIsOpen, openDelay]);\n\n  const closeWithDelay = React.useCallback(() => {\n    if (enterTimeout.current) {\n      clearTimeout(enterTimeout.current);\n    }\n    exitTimeout.current = setTimeout(() => setIsOpen(false), closeDelay);\n  }, [closeDelay, setIsOpen]);\n\n  React.useEffect(\n    () => () => {\n      clearTimeout(enterTimeout.current);\n      clearTimeout(exitTimeout.current);\n    },\n    []\n  );\n\n  let newChildren = children;\n\n  if (typeof children === 'string') {\n    newChildren = <Box>{children}</Box>;\n  }\n\n  newChildren = React.cloneElement(newChildren, {\n    'onPress': composeEventHandlers<any>(newChildren.props.onPress, () => {\n      if (closeOnClick) {\n        closeWithDelay();\n      }\n    }),\n    'onFocus': composeEventHandlers<any>(\n      newChildren.props.onFocus,\n      openWithDelay\n    ),\n    'onBlur': composeEventHandlers<any>(\n      newChildren.props.onBlur,\n      closeWithDelay\n    ),\n    'onMouseEnter': composeEventHandlers<any>(\n      newChildren.props.onMouseEnter,\n      openWithDelay\n    ),\n    'onMouseLeave': composeEventHandlers<any>(\n      newChildren.props.onMouseLeave,\n      closeWithDelay\n    ),\n    'ref': mergeRefs([newChildren.ref, targetRef]),\n\n    'aria-describedby': isOpen ? tooltipID : undefined,\n  });\n\n  useKeyboardDismissable({\n    enabled: isOpen,\n    callback: () => setIsOpen(false),\n  });\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n  return (\n    <>\n      {newChildren}\n      {isOpen && (\n        <OverlayContainer>\n          <PresenceTransition\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1, transition: { duration: 150 } }}\n            exit={{ opacity: 0, transition: { duration: 100 } }}\n            visible={isOpen}\n            style={StyleSheet.absoluteFill}\n          >\n            <Popper\n              triggerRef={targetRef}\n              onClose={() => setIsOpen(false)}\n              placement={placement}\n              offset={offset}\n            >\n              <Popper.Content isOpen={isOpen}>\n                {hasArrow && (\n                  <Popper.Arrow\n                    borderColor=\"transparent\"\n                    backgroundColor={arrowBg}\n                    height={arrowSize}\n                    width={arrowSize}\n                  />\n                )}\n                <Box\n                  {...resolvedProps}\n                  //@ts-ignore\n                  accessibilityRole={\n                    Platform.OS === 'web' ? 'tooltip' : undefined\n                  }\n                  nativeID={tooltipID}\n                >\n                  {label}\n                </Box>\n              </Popper.Content>\n            </Popper>\n          </PresenceTransition>\n        </OverlayContainer>\n      )}\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}