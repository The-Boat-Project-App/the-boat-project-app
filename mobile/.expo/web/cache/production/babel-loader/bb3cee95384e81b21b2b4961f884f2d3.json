{"ast":null,"code":"\"use strict\";var _defineProperty=require(\"@babel/runtime/helpers/defineProperty\");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=buildTREFromConfig;var _transientRenderEngine=_interopRequireDefault(require(\"@native-html/transient-render-engine\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function buildTREFromConfig(props){var allowedStyles=props.allowedStyles,_props$ignoredStyles=props.ignoredStyles,ignoredStyles=_props$ignoredStyles===void 0?[]:_props$ignoredStyles,ignoredDomTags=props.ignoredDomTags,ignoreDomNode=props.ignoreDomNode,domVisitors=props.domVisitors,htmlParserOptions=props.htmlParserOptions,baseStyle=props.baseStyle,classesStyles=props.classesStyles,tagsStyles=props.tagsStyles,idsStyles=props.idsStyles,enableCSSInlineProcessing=props.enableCSSInlineProcessing,enableUserAgentStyles=props.enableUserAgentStyles,_props$systemFonts=props.systemFonts,systemFonts=_props$systemFonts===void 0?[]:_props$systemFonts,_props$fallbackFonts=props.fallbackFonts,fallbackFonts=_props$fallbackFonts===void 0?{}:_props$fallbackFonts,_props$customHTMLElem=props.customHTMLElementModels,customHTMLElementModels=_props$customHTMLElem===void 0?{}:_props$customHTMLElem,emSize=props.emSize,setMarkersForTNode=props.setMarkersForTNode,selectDomRoot=props.selectDomRoot,dangerouslyDisableHoisting=props.dangerouslyDisableHoisting,dangerouslyDisableWhitespaceCollapsing=props.dangerouslyDisableWhitespaceCollapsing;var customizeHTMLModels=Object.keys(customHTMLElementModels).length?function(defaultModels){return _objectSpread(_objectSpread({},defaultModels),customHTMLElementModels);}:undefined;var fontMap={};systemFonts.forEach(function(font){fontMap[font]=true;});var isFontSupported=function isFontSupported(fontFamily){if(fallbackFonts[fontFamily]){return fallbackFonts[fontFamily];}return fontMap[fontFamily]||false;};return new _transientRenderEngine.default({customizeHTMLModels:customizeHTMLModels,cssProcessorConfig:{isFontSupported:isFontSupported,inlinePropertiesBlacklist:ignoredStyles,inlinePropertiesWhitelist:allowedStyles,rootFontSize:emSize},htmlParserOptions:_objectSpread({decodeEntities:true},htmlParserOptions),stylesConfig:{baseStyle:baseStyle,enableCSSInlineProcessing:enableCSSInlineProcessing,enableUserAgentStyles:enableUserAgentStyles,classesStyles:classesStyles,idsStyles:idsStyles,tagsStyles:tagsStyles},ignoredDomTags:ignoredDomTags,ignoreDomNode:ignoreDomNode,domVisitors:domVisitors,setMarkersForTNode:setMarkersForTNode,selectDomRoot:selectDomRoot,dangerouslyDisableHoisting:dangerouslyDisableHoisting,dangerouslyDisableWhitespaceCollapsing:dangerouslyDisableWhitespaceCollapsing});}","map":{"version":3,"mappings":"m7BACA,sLAae,QAASA,mBAAT,CAA4BC,KAA5B,CAAwD,CACrE,GACEC,cADF,CAsBID,KAtBJ,CACEC,aADF,sBAsBID,KAtBJ,CAGEE,aAHF,CAGEA,aAHF,+BAGkB,EAHlB,sBAIEC,cAJF,CAsBIH,KAtBJ,CAIEG,cAJF,CAKEC,aALF,CAsBIJ,KAtBJ,CAKEI,aALF,CAMEC,WANF,CAsBIL,KAtBJ,CAMEK,WANF,CAOEC,iBAPF,CAsBIN,KAtBJ,CAOEM,iBAPF,CAQEC,SARF,CAsBIP,KAtBJ,CAQEO,SARF,CASEC,aATF,CAsBIR,KAtBJ,CASEQ,aATF,CAUEC,UAVF,CAsBIT,KAtBJ,CAUES,UAVF,CAWEC,SAXF,CAsBIV,KAtBJ,CAWEU,SAXF,CAYEC,yBAZF,CAsBIX,KAtBJ,CAYEW,yBAZF,CAaEC,qBAbF,CAsBIZ,KAtBJ,CAaEY,qBAbF,oBAsBIZ,KAtBJ,CAcEa,WAdF,CAcEA,WAdF,6BAcgB,EAdhB,yCAsBIb,KAtBJ,CAeEc,aAfF,CAeEA,aAfF,+BAekB,EAflB,4CAsBId,KAtBJ,CAgBEe,uBAhBF,CAgBEA,uBAhBF,gCAgB4B,EAhB5B,uBAiBEC,MAjBF,CAsBIhB,KAtBJ,CAiBEgB,MAjBF,CAkBEC,kBAlBF,CAsBIjB,KAtBJ,CAkBEiB,kBAlBF,CAmBEC,aAnBF,CAsBIlB,KAtBJ,CAmBEkB,aAnBF,CAoBEC,0BApBF,CAsBInB,KAtBJ,CAoBEmB,0BApBF,CAqBEC,sCArBF,CAsBIpB,KAtBJ,CAqBEoB,sCArBF,CAuBA,GAAMC,oBAAmB,CAAGC,MAAM,CAACC,IAAPD,CAAYP,uBAAZO,EAAqCE,MAArCF,CACvBG,sBAAD,CAAuE,CACrE,sCAAYA,aAAZ,EAA8BV,uBAA9B,EAFsB,EAIxBW,SAJJ,CAKA,GAAMC,QAAO,CAAG,EAAhB,CACAd,WAAW,CAACe,OAAZf,CAAqBgB,aAAD,CAAU,CAC5BF,OAAO,CAACE,IAAD,CAAPF,CAAgB,IAAhBA,CADF,GAGA,GAAMG,gBAAe,CAAIC,QAAnBD,gBAAmBC,WAAD,CAAwB,CAC9C,GAAIjB,aAAa,CAACiB,UAAD,CAAjB,CAA6D,CAC3D,MAAOjB,cAAa,CAACiB,UAAD,CAApB,CACD,CAED,MAAOJ,QAAO,CAACI,UAAD,CAAPJ,EAAuB,KAA9B,CALF,EAOA,MAAO,IAAIK,+BAAJ,CAAkB,CACvBX,mBADuB,CACvBA,mBADuB,CAEvBY,kBAAkB,CAAE,CAClBH,eADkB,CAClBA,eADkB,CAElBI,yBAAyB,CAAEhC,aAFT,CAGlBiC,yBAAyB,CAAElC,aAHT,CAIlBmC,YAAY,CAAEpB,MAJI,CAFG,CAQvBV,iBAAiB,gBACf+B,cAAc,CAAE,IADD,EAEZ/B,iBAFY,CARM,CAYvBgC,YAAY,CAAE,CACZ/B,SADY,CACZA,SADY,CAEZI,yBAFY,CAEZA,yBAFY,CAGZC,qBAHY,CAGZA,qBAHY,CAIZJ,aAJY,CAIZA,aAJY,CAKZE,SALY,CAKZA,SALY,CAMZD,qBANY,CAZS,CAoBvBN,cApBuB,CAoBvBA,cApBuB,CAqBvBC,aArBuB,CAqBvBA,aArBuB,CAsBvBC,WAtBuB,CAsBvBA,WAtBuB,CAuBvBY,kBAvBuB,CAuBvBA,kBAvBuB,CAwBvBC,aAxBuB,CAwBvBA,aAxBuB,CAyBvBC,0BAzBuB,CAyBvBA,0BAzBuB,CA0BvBC,6EA1BuB,CAAlB,CAAP,CA4BD","names":["buildTREFromConfig","props","allowedStyles","ignoredStyles","ignoredDomTags","ignoreDomNode","domVisitors","htmlParserOptions","baseStyle","classesStyles","tagsStyles","idsStyles","enableCSSInlineProcessing","enableUserAgentStyles","systemFonts","fallbackFonts","customHTMLElementModels","emSize","setMarkersForTNode","selectDomRoot","dangerouslyDisableHoisting","dangerouslyDisableWhitespaceCollapsing","customizeHTMLModels","Object","keys","length","defaultModels","undefined","fontMap","forEach","font","isFontSupported","fontFamily","TRenderEngine","cssProcessorConfig","inlinePropertiesBlacklist","inlinePropertiesWhitelist","rootFontSize","decodeEntities","stylesConfig"],"sources":["buildTREFromConfig.ts"],"sourcesContent":["import { TRenderEngineConfig } from '../shared-types';\nimport TRenderEngine, {\n  HTMLModelRecord,\n  TagName\n} from '@native-html/transient-render-engine';\n\n/**\n * Build a {@link TRenderEngine} instance from a configuration object.\n *\n * @remarks This utility can be useful to test and debug the TRE layer of your\n * application.\n *\n * @param props - The configuration from which a TRE should be built.\n */\nexport default function buildTREFromConfig(props: TRenderEngineConfig) {\n  const {\n    allowedStyles,\n    // TODO fix upstream\n    ignoredStyles = [],\n    ignoredDomTags,\n    ignoreDomNode,\n    domVisitors,\n    htmlParserOptions,\n    baseStyle,\n    classesStyles,\n    tagsStyles,\n    idsStyles,\n    enableCSSInlineProcessing,\n    enableUserAgentStyles,\n    systemFonts = [],\n    fallbackFonts = {},\n    customHTMLElementModels = {},\n    emSize,\n    setMarkersForTNode,\n    selectDomRoot,\n    dangerouslyDisableHoisting,\n    dangerouslyDisableWhitespaceCollapsing\n  } = props;\n  const customizeHTMLModels = Object.keys(customHTMLElementModels).length\n    ? (defaultModels: HTMLModelRecord<TagName>): HTMLModelRecord<TagName> => {\n        return { ...defaultModels, ...customHTMLElementModels };\n      }\n    : undefined;\n  const fontMap = {} as Record<string, true>;\n  systemFonts.forEach((font) => {\n    fontMap[font] = true;\n  });\n  const isFontSupported = (fontFamily: string) => {\n    if (fallbackFonts[fontFamily as keyof typeof fallbackFonts]) {\n      return fallbackFonts[fontFamily as keyof typeof fallbackFonts];\n    }\n    /* istanbul ignore next */\n    return fontMap[fontFamily] || false;\n  };\n  return new TRenderEngine({\n    customizeHTMLModels,\n    cssProcessorConfig: {\n      isFontSupported,\n      inlinePropertiesBlacklist: ignoredStyles,\n      inlinePropertiesWhitelist: allowedStyles,\n      rootFontSize: emSize\n    },\n    htmlParserOptions: {\n      decodeEntities: true,\n      ...htmlParserOptions\n    },\n    stylesConfig: {\n      baseStyle,\n      enableCSSInlineProcessing,\n      enableUserAgentStyles,\n      classesStyles,\n      idsStyles,\n      tagsStyles\n    },\n    ignoredDomTags,\n    ignoreDomNode,\n    domVisitors,\n    setMarkersForTNode,\n    selectDomRoot,\n    dangerouslyDisableHoisting,\n    dangerouslyDisableWhitespaceCollapsing\n  });\n}\n"]},"metadata":{},"sourceType":"script"}