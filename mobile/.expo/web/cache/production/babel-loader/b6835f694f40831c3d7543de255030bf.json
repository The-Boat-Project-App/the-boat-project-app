{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import{getItemCount}from'@react-stately/collections';import{getItemId}from\"./utils\";import{isFocusVisible}from'@react-aria/interactions';import{useHover,usePress}from'@react-native-aria/interactions';import{isMac,isWebKit,mergeProps,useSlotId}from'@react-aria/utils';import{useSelectableItem}from'@react-aria/selection';import{useMapDomPropsToRN}from'@react-native-aria/utils';export function useOption(props,state,ref){var isSelected=props.isSelected,isDisabled=props.isDisabled,key=props.key,shouldSelectOnPressUp=props.shouldSelectOnPressUp,shouldFocusOnHover=props.shouldFocusOnHover,isVirtualized=props.isVirtualized,shouldUseVirtualFocus=props.shouldUseVirtualFocus;var labelId=useSlotId();var descriptionId=useSlotId();var _optionProps={'role':'option','aria-disabled':isDisabled,'aria-selected':isSelected};if(!(isMac()&&isWebKit())){_optionProps['aria-label']=props['aria-label'];_optionProps['aria-labelledby']=labelId;_optionProps['aria-describedby']=descriptionId;}if(isVirtualized){_optionProps['aria-posinset']=state.collection.getItem(key).index+1;_optionProps['aria-setsize']=getItemCount(state.collection);}var _useSelectableItem=useSelectableItem({selectionManager:state.selectionManager,key:key,ref:ref,shouldSelectOnPressUp:shouldSelectOnPressUp,isVirtualized:isVirtualized,shouldUseVirtualFocus:shouldUseVirtualFocus}),itemProps=_useSelectableItem.itemProps;var _usePress=usePress(_objectSpread(_objectSpread({},itemProps),{},{isDisabled:isDisabled,preventFocusOnPress:shouldUseVirtualFocus})),pressProps=_usePress.pressProps;var _useHover=useHover({isDisabled:isDisabled||!shouldFocusOnHover,onHoverStart:function onHoverStart(){if(!isFocusVisible()){state.selectionManager.setFocused(true);state.selectionManager.setFocusedKey(key);}}},ref),hoverProps=_useHover.hoverProps;var onMouseDown=function onMouseDown(e){return e.stopPropagation();};_optionProps=_objectSpread(_objectSpread(_objectSpread({},_optionProps),mergeProps(pressProps,hoverProps)),{},{id:getItemId(state,key),onMouseDown:onMouseDown});var optionProps=useMapDomPropsToRN(_optionProps,ref);return{optionProps:optionProps,labelProps:{nativeID:labelId},descriptionProps:{nativeID:descriptionId}};}","map":{"version":3,"mappings":"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","names":["getItemCount","getItemId","isFocusVisible","useHover","usePress","isMac","isWebKit","mergeProps","useSlotId","useSelectableItem","useMapDomPropsToRN","useOption","props","state","ref","isSelected","isDisabled","key","shouldSelectOnPressUp","shouldFocusOnHover","isVirtualized","shouldUseVirtualFocus","labelId","descriptionId","_optionProps","collection","getItem","index","selectionManager","itemProps","preventFocusOnPress","pressProps","onHoverStart","setFocused","setFocusedKey","hoverProps","onMouseDown","e","stopPropagation","id","optionProps","labelProps","nativeID","descriptionProps"],"sources":["useOption.web.ts"],"sourcesContent":["import { getItemCount } from '@react-stately/collections';\nimport { getItemId } from './utils';\nimport { Key, RefObject } from 'react';\nimport { isFocusVisible } from '@react-aria/interactions';\nimport { useHover, usePress } from '@react-native-aria/interactions';\nimport { isMac, isWebKit, mergeProps, useSlotId } from '@react-aria/utils';\nimport { ListState } from '@react-stately/list';\nimport { useSelectableItem } from '@react-aria/selection';\nimport { useMapDomPropsToRN } from '@react-native-aria/utils';\n\ninterface OptionAria {\n  /** Props for the option element. */\n  optionProps: any;\n\n  /** Props for the main text element inside the option. */\n  labelProps: any;\n\n  /** Props for the description text element inside the option, if any. */\n  descriptionProps: any;\n}\n\ninterface AriaOptionProps {\n  /** Whether the option is disabled. */\n  'isDisabled'?: boolean;\n\n  /** Whether the option is selected. */\n  'isSelected'?: boolean;\n\n  /** A screen reader only label for the option. */\n  'aria-label'?: string;\n\n  /** The unique key for the option. */\n  'key'?: Key;\n\n  /** Whether selection should occur on press up instead of press down. */\n  'shouldSelectOnPressUp'?: boolean;\n\n  /** Whether the option should be focused when the user hovers over it. */\n  'shouldFocusOnHover'?: boolean;\n\n  /** Whether the option is contained in a virtual scrolling listbox. */\n  'isVirtualized'?: boolean;\n\n  /** Whether the option should use virtual focus instead of being focused directly. */\n  'shouldUseVirtualFocus'?: boolean;\n}\n\n/**\n * Provides the behavior and accessibility implementation for an option in a listbox.\n * See `useListBox` for more details about listboxes.\n * @param props - Props for the option.\n * @param state - State for the listbox, as returned by `useListState`.\n */\nexport function useOption<T>(\n  props: AriaOptionProps,\n  state: ListState<T>,\n  ref: RefObject<HTMLElement>\n): OptionAria {\n  let {\n    isSelected,\n    isDisabled,\n    key,\n    shouldSelectOnPressUp,\n    shouldFocusOnHover,\n    isVirtualized,\n    shouldUseVirtualFocus,\n  } = props;\n\n  let labelId = useSlotId();\n  let descriptionId = useSlotId();\n\n  let _optionProps: any = {\n    'role': 'option',\n    'aria-disabled': isDisabled,\n    'aria-selected': isSelected,\n  };\n\n  // Safari with VoiceOver on macOS misreads options with aria-labelledby or aria-label as simply \"text\".\n  // We should not map slots to the label and description on Safari and instead just have VoiceOver read the textContent.\n  // https://bugs.webkit.org/show_bug.cgi?id=209279\n  if (!(isMac() && isWebKit())) {\n    _optionProps['aria-label'] = props['aria-label'];\n    _optionProps['aria-labelledby'] = labelId;\n    _optionProps['aria-describedby'] = descriptionId;\n  }\n\n  if (isVirtualized) {\n    //@ts-ignore\n    _optionProps['aria-posinset'] = state.collection.getItem(key).index + 1;\n    _optionProps['aria-setsize'] = getItemCount(state.collection);\n  }\n\n  let { itemProps } = useSelectableItem({\n    selectionManager: state.selectionManager,\n    //@ts-ignore\n    key,\n    ref,\n    shouldSelectOnPressUp,\n    isVirtualized,\n    shouldUseVirtualFocus,\n  });\n\n  let { pressProps } = usePress({\n    ...itemProps,\n    isDisabled,\n    preventFocusOnPress: shouldUseVirtualFocus,\n  });\n\n  let { hoverProps } = useHover(\n    {\n      isDisabled: isDisabled || !shouldFocusOnHover,\n      onHoverStart() {\n        if (!isFocusVisible()) {\n          state.selectionManager.setFocused(true);\n          //@ts-ignore\n          state.selectionManager.setFocusedKey(key);\n        }\n      },\n    },\n    ref\n  );\n\n  // Putting this as a last resort, after several hours of debugging.\n  // Why?\n  // tabListProps adds onMouseDown with preventDefault in useSelectableCollection.ts (React Aria) and react-native-web uses onClick for onPress.\n  // This results in tab button not getting focused when clicked\n  // See this example - https://codesandbox.io/s/issue-i-know-but-dont-know-why-1-ydyw5?file=/src/App.js\n  const onMouseDown = (e: any) => e.stopPropagation();\n\n  _optionProps = {\n    ..._optionProps,\n    ...mergeProps(pressProps, hoverProps),\n    //@ts-ignore\n    id: getItemId(state, key),\n    onMouseDown,\n  };\n\n  const optionProps = useMapDomPropsToRN(_optionProps, ref);\n\n  return {\n    optionProps,\n    labelProps: {\n      nativeID: labelId,\n    },\n    descriptionProps: {\n      nativeID: descriptionId,\n    },\n  };\n}\n"]},"metadata":{},"sourceType":"module"}