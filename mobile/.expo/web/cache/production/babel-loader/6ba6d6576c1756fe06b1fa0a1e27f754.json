{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";var dataUriPattern=/^data:/;export var ImageUriCache=function(){function ImageUriCache(){_classCallCheck(this,ImageUriCache);}_createClass(ImageUriCache,null,[{key:\"has\",value:function has(uri){var entries=ImageUriCache._entries;var isDataUri=dataUriPattern.test(uri);return isDataUri||Boolean(entries[uri]);}},{key:\"add\",value:function add(uri){var entries=ImageUriCache._entries;var lastUsedTimestamp=Date.now();if(entries[uri]){entries[uri].lastUsedTimestamp=lastUsedTimestamp;entries[uri].refCount+=1;}else{entries[uri]={lastUsedTimestamp:lastUsedTimestamp,refCount:1};}}},{key:\"remove\",value:function remove(uri){var entries=ImageUriCache._entries;if(entries[uri]){entries[uri].refCount-=1;}ImageUriCache._cleanUpIfNeeded();}},{key:\"_cleanUpIfNeeded\",value:function _cleanUpIfNeeded(){var entries=ImageUriCache._entries;var imageUris=Object.keys(entries);if(imageUris.length+1>ImageUriCache._maximumEntries){var leastRecentlyUsedKey;var leastRecentlyUsedEntry;imageUris.forEach(function(uri){var entry=entries[uri];if((!leastRecentlyUsedEntry||entry.lastUsedTimestamp<leastRecentlyUsedEntry.lastUsedTimestamp)&&entry.refCount===0){leastRecentlyUsedKey=uri;leastRecentlyUsedEntry=entry;}});if(leastRecentlyUsedKey){delete entries[leastRecentlyUsedKey];}}}}]);return ImageUriCache;}();ImageUriCache._maximumEntries=256;ImageUriCache._entries={};var id=0;var requests={};var ImageLoader={abort:function abort(requestId){var image=requests[\"\"+requestId];if(image){image.onerror=null;image.onload=null;image=null;delete requests[\"\"+requestId];}},getSize:function getSize(uri,success,failure){var complete=false;var interval=setInterval(callback,16);var requestId=ImageLoader.load(uri,callback,errorCallback);function callback(){var image=requests[\"\"+requestId];if(image){var naturalHeight=image.naturalHeight,naturalWidth=image.naturalWidth;if(naturalHeight&&naturalWidth){success(naturalWidth,naturalHeight);complete=true;}}if(complete){ImageLoader.abort(requestId);clearInterval(interval);}}function errorCallback(){if(typeof failure==='function'){failure();}ImageLoader.abort(requestId);clearInterval(interval);}},has:function has(uri){return ImageUriCache.has(uri);},load:function load(uri,onLoad,onError){id+=1;var image=new window.Image();image.onerror=onError;image.onload=function(e){var onDecode=function onDecode(){return onLoad({nativeEvent:e});};if(typeof image.decode==='function'){image.decode().then(onDecode,onDecode);}else{setTimeout(onDecode,0);}};image.src=uri;requests[\"\"+id]=image;return id;},prefetch:function prefetch(uri){return new Promise(function(resolve,reject){ImageLoader.load(uri,function(){ImageUriCache.add(uri);ImageUriCache.remove(uri);resolve();},reject);});},queryCache:function queryCache(uris){var result={};uris.forEach(function(u){if(ImageUriCache.has(u)){result[u]='disk/memory';}});return Promise.resolve(result);}};export default ImageLoader;","map":{"version":3,"names":["dataUriPattern","ImageUriCache","uri","entries","_entries","isDataUri","test","Boolean","lastUsedTimestamp","Date","now","refCount","_cleanUpIfNeeded","imageUris","Object","keys","length","_maximumEntries","leastRecentlyUsedKey","leastRecentlyUsedEntry","forEach","entry","id","requests","ImageLoader","abort","requestId","image","onerror","onload","getSize","success","failure","complete","interval","setInterval","callback","load","errorCallback","naturalHeight","naturalWidth","clearInterval","has","onLoad","onError","window","Image","e","onDecode","nativeEvent","decode","then","setTimeout","src","prefetch","Promise","resolve","reject","add","remove","queryCache","uris","result","u"],"sources":["/Users/matthieu/Documents/boatproject/node_modules/react-native-web/dist/modules/ImageLoader/index.js"],"sourcesContent":["/**\n * Copyright (c) Nicolas Gallagher.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n */\nvar dataUriPattern = /^data:/;\nexport class ImageUriCache {\n  static has(uri) {\n    var entries = ImageUriCache._entries;\n    var isDataUri = dataUriPattern.test(uri);\n    return isDataUri || Boolean(entries[uri]);\n  }\n\n  static add(uri) {\n    var entries = ImageUriCache._entries;\n    var lastUsedTimestamp = Date.now();\n\n    if (entries[uri]) {\n      entries[uri].lastUsedTimestamp = lastUsedTimestamp;\n      entries[uri].refCount += 1;\n    } else {\n      entries[uri] = {\n        lastUsedTimestamp,\n        refCount: 1\n      };\n    }\n  }\n\n  static remove(uri) {\n    var entries = ImageUriCache._entries;\n\n    if (entries[uri]) {\n      entries[uri].refCount -= 1;\n    } // Free up entries when the cache is \"full\"\n\n\n    ImageUriCache._cleanUpIfNeeded();\n  }\n\n  static _cleanUpIfNeeded() {\n    var entries = ImageUriCache._entries;\n    var imageUris = Object.keys(entries);\n\n    if (imageUris.length + 1 > ImageUriCache._maximumEntries) {\n      var leastRecentlyUsedKey;\n      var leastRecentlyUsedEntry;\n      imageUris.forEach(uri => {\n        var entry = entries[uri];\n\n        if ((!leastRecentlyUsedEntry || entry.lastUsedTimestamp < leastRecentlyUsedEntry.lastUsedTimestamp) && entry.refCount === 0) {\n          leastRecentlyUsedKey = uri;\n          leastRecentlyUsedEntry = entry;\n        }\n      });\n\n      if (leastRecentlyUsedKey) {\n        delete entries[leastRecentlyUsedKey];\n      }\n    }\n  }\n\n}\nImageUriCache._maximumEntries = 256;\nImageUriCache._entries = {};\nvar id = 0;\nvar requests = {};\nvar ImageLoader = {\n  abort(requestId) {\n    var image = requests[\"\" + requestId];\n\n    if (image) {\n      image.onerror = null;\n      image.onload = null;\n      image = null;\n      delete requests[\"\" + requestId];\n    }\n  },\n\n  getSize(uri, success, failure) {\n    var complete = false;\n    var interval = setInterval(callback, 16);\n    var requestId = ImageLoader.load(uri, callback, errorCallback);\n\n    function callback() {\n      var image = requests[\"\" + requestId];\n\n      if (image) {\n        var naturalHeight = image.naturalHeight,\n            naturalWidth = image.naturalWidth;\n\n        if (naturalHeight && naturalWidth) {\n          success(naturalWidth, naturalHeight);\n          complete = true;\n        }\n      }\n\n      if (complete) {\n        ImageLoader.abort(requestId);\n        clearInterval(interval);\n      }\n    }\n\n    function errorCallback() {\n      if (typeof failure === 'function') {\n        failure();\n      }\n\n      ImageLoader.abort(requestId);\n      clearInterval(interval);\n    }\n  },\n\n  has(uri) {\n    return ImageUriCache.has(uri);\n  },\n\n  load(uri, onLoad, onError) {\n    id += 1;\n    var image = new window.Image();\n    image.onerror = onError;\n\n    image.onload = e => {\n      // avoid blocking the main thread\n      var onDecode = () => onLoad({\n        nativeEvent: e\n      });\n\n      if (typeof image.decode === 'function') {\n        // Safari currently throws exceptions when decoding svgs.\n        // We want to catch that error and allow the load handler\n        // to be forwarded to the onLoad handler in this case\n        image.decode().then(onDecode, onDecode);\n      } else {\n        setTimeout(onDecode, 0);\n      }\n    };\n\n    image.src = uri;\n    requests[\"\" + id] = image;\n    return id;\n  },\n\n  prefetch(uri) {\n    return new Promise((resolve, reject) => {\n      ImageLoader.load(uri, () => {\n        // Add the uri to the cache so it can be immediately displayed when used\n        // but also immediately remove it to correctly reflect that it has no active references\n        ImageUriCache.add(uri);\n        ImageUriCache.remove(uri);\n        resolve();\n      }, reject);\n    });\n  },\n\n  queryCache(uris) {\n    var result = {};\n    uris.forEach(u => {\n      if (ImageUriCache.has(u)) {\n        result[u] = 'disk/memory';\n      }\n    });\n    return Promise.resolve(result);\n  }\n\n};\nexport default ImageLoader;"],"mappings":"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"},"metadata":{},"sourceType":"module"}