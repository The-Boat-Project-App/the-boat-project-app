{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return _extends.apply(this,arguments);}import{getHeaderTitle,Header,SafeAreaProviderCompat,Screen}from'@react-navigation/elements';import*as React from'react';import Platform from\"react-native-web/dist/exports/Platform\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import{SafeAreaInsetsContext}from'react-native-safe-area-context';import BottomTabBarHeightCallbackContext from\"../utils/BottomTabBarHeightCallbackContext\";import BottomTabBarHeightContext from\"../utils/BottomTabBarHeightContext\";import BottomTabBar,{getTabBarHeight}from\"./BottomTabBar\";import{MaybeScreen,MaybeScreenContainer}from\"./ScreenFallback\";export default function BottomTabView(props){var _props$tabBar=props.tabBar,tabBar=_props$tabBar===void 0?function(props){return React.createElement(BottomTabBar,props);}:_props$tabBar,state=props.state,navigation=props.navigation,descriptors=props.descriptors,safeAreaInsets=props.safeAreaInsets,_props$detachInactive=props.detachInactiveScreens,detachInactiveScreens=_props$detachInactive===void 0?Platform.OS==='web'||Platform.OS==='android'||Platform.OS==='ios':_props$detachInactive,sceneContainerStyle=props.sceneContainerStyle;var focusedRouteKey=state.routes[state.index].key;var _React$useState=React.useState([focusedRouteKey]),_React$useState2=_slicedToArray(_React$useState,2),loaded=_React$useState2[0],setLoaded=_React$useState2[1];if(!loaded.includes(focusedRouteKey)){setLoaded([].concat(_toConsumableArray(loaded),[focusedRouteKey]));}var dimensions=SafeAreaProviderCompat.initialMetrics.frame;var _React$useState3=React.useState(function(){return getTabBarHeight({state:state,descriptors:descriptors,dimensions:dimensions,layout:{width:dimensions.width,height:0},insets:_objectSpread(_objectSpread({},SafeAreaProviderCompat.initialMetrics.insets),props.safeAreaInsets),style:descriptors[state.routes[state.index].key].options.tabBarStyle});}),_React$useState4=_slicedToArray(_React$useState3,2),tabBarHeight=_React$useState4[0],setTabBarHeight=_React$useState4[1];var renderTabBar=function renderTabBar(){return React.createElement(SafeAreaInsetsContext.Consumer,null,function(insets){var _ref,_safeAreaInsets$top,_ref2,_safeAreaInsets$right,_ref3,_safeAreaInsets$botto,_ref4,_safeAreaInsets$left;return tabBar({state:state,descriptors:descriptors,navigation:navigation,insets:{top:(_ref=(_safeAreaInsets$top=safeAreaInsets===null||safeAreaInsets===void 0?void 0:safeAreaInsets.top)!==null&&_safeAreaInsets$top!==void 0?_safeAreaInsets$top:insets===null||insets===void 0?void 0:insets.top)!==null&&_ref!==void 0?_ref:0,right:(_ref2=(_safeAreaInsets$right=safeAreaInsets===null||safeAreaInsets===void 0?void 0:safeAreaInsets.right)!==null&&_safeAreaInsets$right!==void 0?_safeAreaInsets$right:insets===null||insets===void 0?void 0:insets.right)!==null&&_ref2!==void 0?_ref2:0,bottom:(_ref3=(_safeAreaInsets$botto=safeAreaInsets===null||safeAreaInsets===void 0?void 0:safeAreaInsets.bottom)!==null&&_safeAreaInsets$botto!==void 0?_safeAreaInsets$botto:insets===null||insets===void 0?void 0:insets.bottom)!==null&&_ref3!==void 0?_ref3:0,left:(_ref4=(_safeAreaInsets$left=safeAreaInsets===null||safeAreaInsets===void 0?void 0:safeAreaInsets.left)!==null&&_safeAreaInsets$left!==void 0?_safeAreaInsets$left:insets===null||insets===void 0?void 0:insets.left)!==null&&_ref4!==void 0?_ref4:0}});});};var routes=state.routes;return React.createElement(SafeAreaProviderCompat,null,React.createElement(MaybeScreenContainer,{enabled:detachInactiveScreens,hasTwoStates:true,style:styles.container},routes.map(function(route,index){var descriptor=descriptors[route.key];var _descriptor$options=descriptor.options,_descriptor$options$l=_descriptor$options.lazy,lazy=_descriptor$options$l===void 0?true:_descriptor$options$l,unmountOnBlur=_descriptor$options.unmountOnBlur;var isFocused=state.index===index;if(unmountOnBlur&&!isFocused){return null;}if(lazy&&!loaded.includes(route.key)&&!isFocused){return null;}var _descriptor$options$h=descriptor.options.header,header=_descriptor$options$h===void 0?function(_ref5){var layout=_ref5.layout,options=_ref5.options;return React.createElement(Header,_extends({},options,{layout:layout,title:getHeaderTitle(options,route.name)}));}:_descriptor$options$h;return React.createElement(MaybeScreen,{key:route.key,style:[StyleSheet.absoluteFill,{zIndex:isFocused?0:-1}],visible:isFocused,enabled:detachInactiveScreens},React.createElement(BottomTabBarHeightContext.Provider,{value:tabBarHeight},React.createElement(Screen,{focused:isFocused,route:descriptor.route,navigation:descriptor.navigation,headerShown:descriptor.options.headerShown,headerTransparent:descriptor.options.headerTransparent,headerStatusBarHeight:descriptor.options.headerStatusBarHeight,header:header({layout:dimensions,route:descriptor.route,navigation:descriptor.navigation,options:descriptor.options}),style:sceneContainerStyle},descriptor.render())));})),React.createElement(BottomTabBarHeightCallbackContext.Provider,{value:setTabBarHeight},renderTabBar()));}var styles=StyleSheet.create({container:{flex:1,overflow:'hidden'}});","map":{"version":3,"mappings":"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","names":["getHeaderTitle","Header","SafeAreaProviderCompat","Screen","React","SafeAreaInsetsContext","BottomTabBarHeightCallbackContext","BottomTabBarHeightContext","BottomTabBar","getTabBarHeight","MaybeScreen","MaybeScreenContainer","BottomTabView","props","tabBar","state","navigation","descriptors","safeAreaInsets","detachInactiveScreens","Platform","OS","sceneContainerStyle","focusedRouteKey","routes","index","key","useState","loaded","setLoaded","includes","dimensions","initialMetrics","frame","layout","width","height","insets","style","options","tabBarStyle","tabBarHeight","setTabBarHeight","renderTabBar","Consumer","top","right","bottom","left","enabled","hasTwoStates","styles","container","map","route","descriptor","lazy","unmountOnBlur","isFocused","header","title","name","StyleSheet","absoluteFill","zIndex","visible","Provider","value","focused","headerShown","headerTransparent","headerStatusBarHeight","render","create","flex","overflow"],"sources":["BottomTabView.tsx"],"sourcesContent":["import {\n  getHeaderTitle,\n  Header,\n  SafeAreaProviderCompat,\n  Screen,\n} from '@react-navigation/elements';\nimport type {\n  ParamListBase,\n  TabNavigationState,\n} from '@react-navigation/native';\nimport * as React from 'react';\nimport { Platform, StyleSheet } from 'react-native';\nimport { SafeAreaInsetsContext } from 'react-native-safe-area-context';\n\nimport type {\n  BottomTabBarProps,\n  BottomTabDescriptorMap,\n  BottomTabHeaderProps,\n  BottomTabNavigationConfig,\n  BottomTabNavigationHelpers,\n  BottomTabNavigationProp,\n} from '../types';\nimport BottomTabBarHeightCallbackContext from '../utils/BottomTabBarHeightCallbackContext';\nimport BottomTabBarHeightContext from '../utils/BottomTabBarHeightContext';\nimport BottomTabBar, { getTabBarHeight } from './BottomTabBar';\nimport { MaybeScreen, MaybeScreenContainer } from './ScreenFallback';\n\ntype Props = BottomTabNavigationConfig & {\n  state: TabNavigationState<ParamListBase>;\n  navigation: BottomTabNavigationHelpers;\n  descriptors: BottomTabDescriptorMap;\n};\n\nexport default function BottomTabView(props: Props) {\n  const {\n    tabBar = (props: BottomTabBarProps) => <BottomTabBar {...props} />,\n    state,\n    navigation,\n    descriptors,\n    safeAreaInsets,\n    detachInactiveScreens = Platform.OS === 'web' ||\n      Platform.OS === 'android' ||\n      Platform.OS === 'ios',\n    sceneContainerStyle,\n  } = props;\n\n  const focusedRouteKey = state.routes[state.index].key;\n  const [loaded, setLoaded] = React.useState([focusedRouteKey]);\n\n  if (!loaded.includes(focusedRouteKey)) {\n    setLoaded([...loaded, focusedRouteKey]);\n  }\n\n  const dimensions = SafeAreaProviderCompat.initialMetrics.frame;\n  const [tabBarHeight, setTabBarHeight] = React.useState(() =>\n    getTabBarHeight({\n      state,\n      descriptors,\n      dimensions,\n      layout: { width: dimensions.width, height: 0 },\n      insets: {\n        ...SafeAreaProviderCompat.initialMetrics.insets,\n        ...props.safeAreaInsets,\n      },\n      style: descriptors[state.routes[state.index].key].options.tabBarStyle,\n    })\n  );\n\n  const renderTabBar = () => {\n    return (\n      <SafeAreaInsetsContext.Consumer>\n        {(insets) =>\n          tabBar({\n            state: state,\n            descriptors: descriptors,\n            navigation: navigation,\n            insets: {\n              top: safeAreaInsets?.top ?? insets?.top ?? 0,\n              right: safeAreaInsets?.right ?? insets?.right ?? 0,\n              bottom: safeAreaInsets?.bottom ?? insets?.bottom ?? 0,\n              left: safeAreaInsets?.left ?? insets?.left ?? 0,\n            },\n          })\n        }\n      </SafeAreaInsetsContext.Consumer>\n    );\n  };\n\n  const { routes } = state;\n\n  return (\n    <SafeAreaProviderCompat>\n      <MaybeScreenContainer\n        enabled={detachInactiveScreens}\n        hasTwoStates\n        style={styles.container}\n      >\n        {routes.map((route, index) => {\n          const descriptor = descriptors[route.key];\n          const { lazy = true, unmountOnBlur } = descriptor.options;\n          const isFocused = state.index === index;\n\n          if (unmountOnBlur && !isFocused) {\n            return null;\n          }\n\n          if (lazy && !loaded.includes(route.key) && !isFocused) {\n            // Don't render a lazy screen if we've never navigated to it\n            return null;\n          }\n\n          const {\n            header = ({ layout, options }: BottomTabHeaderProps) => (\n              <Header\n                {...options}\n                layout={layout}\n                title={getHeaderTitle(options, route.name)}\n              />\n            ),\n          } = descriptor.options;\n\n          return (\n            <MaybeScreen\n              key={route.key}\n              style={[StyleSheet.absoluteFill, { zIndex: isFocused ? 0 : -1 }]}\n              visible={isFocused}\n              enabled={detachInactiveScreens}\n            >\n              <BottomTabBarHeightContext.Provider value={tabBarHeight}>\n                <Screen\n                  focused={isFocused}\n                  route={descriptor.route}\n                  navigation={descriptor.navigation}\n                  headerShown={descriptor.options.headerShown}\n                  headerTransparent={descriptor.options.headerTransparent}\n                  headerStatusBarHeight={\n                    descriptor.options.headerStatusBarHeight\n                  }\n                  header={header({\n                    layout: dimensions,\n                    route: descriptor.route,\n                    navigation:\n                      descriptor.navigation as BottomTabNavigationProp<ParamListBase>,\n                    options: descriptor.options,\n                  })}\n                  style={sceneContainerStyle}\n                >\n                  {descriptor.render()}\n                </Screen>\n              </BottomTabBarHeightContext.Provider>\n            </MaybeScreen>\n          );\n        })}\n      </MaybeScreenContainer>\n      <BottomTabBarHeightCallbackContext.Provider value={setTabBarHeight}>\n        {renderTabBar()}\n      </BottomTabBarHeightCallbackContext.Provider>\n    </SafeAreaProviderCompat>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    overflow: 'hidden',\n  },\n});\n"]},"metadata":{},"sourceType":"module"}