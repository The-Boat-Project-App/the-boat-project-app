{"ast":null,"code":"'use strict';var url=require('url');var getCurrentScriptSource=require(\"./getCurrentScriptSource\");function createSocketUrl(resourceQuery,currentLocation){var urlParts;if(typeof resourceQuery==='string'&&resourceQuery!==''){urlParts=url.parse(resourceQuery.substr(1).replace('&','?'),true);}else{var scriptHost=getCurrentScriptSource();urlParts=url.parse(scriptHost||'/',true,true);}if(typeof currentLocation==='string'&&currentLocation!==''){currentLocation=url.parse(currentLocation);}else{currentLocation=self.location;}return getSocketUrl(urlParts,currentLocation);}function getSocketUrl(urlParts,loc){var auth=urlParts.auth,query=urlParts.query;var hostname=urlParts.hostname,protocol=urlParts.protocol,port=urlParts.port;if(!port||port==='0'){port=loc.port;}if((hostname==='0.0.0.0'||hostname==='::')&&loc.hostname&&loc.protocol.indexOf('http')===0){hostname=loc.hostname;}if(hostname&&hostname!=='127.0.0.1'&&(loc.protocol==='https:'||urlParts.hostname==='0.0.0.0')){protocol=loc.protocol;}var sockHost=query.sockHost||hostname;var sockPath=query.sockPath||'/sockjs-node';var sockPort=query.sockPort||port;if(sockPort==='location'){sockPort=loc.port;}return url.format({protocol:protocol,auth:auth,hostname:sockHost,port:sockPort,pathname:sockPath});}module.exports=createSocketUrl;","map":{"version":3,"names":["url","require","getCurrentScriptSource","createSocketUrl","resourceQuery","currentLocation","urlParts","parse","substr","replace","scriptHost","self","location","getSocketUrl","loc","auth","query","hostname","protocol","port","indexOf","sockHost","sockPath","sockPort","format","pathname","module","exports"],"sources":["/usr/local/lib/node_modules/expo-cli/node_modules/webpack-dev-server/client/utils/createSocketUrl.js"],"sourcesContent":["'use strict';\n/* global self */\n\nvar url = require('url');\n\nvar getCurrentScriptSource = require('./getCurrentScriptSource');\n\nfunction createSocketUrl(resourceQuery, currentLocation) {\n  var urlParts;\n\n  if (typeof resourceQuery === 'string' && resourceQuery !== '') {\n    // If this bundle is inlined, use the resource query to get the correct url.\n    // format is like `?http://0.0.0.0:8096&sockPort=8097&sockHost=localhost`\n    urlParts = url.parse(resourceQuery // strip leading `?` from query string to get a valid URL\n    .substr(1) // replace first `&` with `?` to have a valid query string\n    .replace('&', '?'), true);\n  } else {\n    // Else, get the url from the <script> this file was called with.\n    var scriptHost = getCurrentScriptSource();\n    urlParts = url.parse(scriptHost || '/', true, true);\n  } // Use parameter to allow passing location in unit tests\n\n\n  if (typeof currentLocation === 'string' && currentLocation !== '') {\n    currentLocation = url.parse(currentLocation);\n  } else {\n    currentLocation = self.location;\n  }\n\n  return getSocketUrl(urlParts, currentLocation);\n}\n/*\n * Gets socket URL based on Script Source/Location\n * (scriptSrc: URL, location: URL) -> URL\n */\n\n\nfunction getSocketUrl(urlParts, loc) {\n  var auth = urlParts.auth,\n      query = urlParts.query;\n  var hostname = urlParts.hostname,\n      protocol = urlParts.protocol,\n      port = urlParts.port;\n\n  if (!port || port === '0') {\n    port = loc.port;\n  } // check ipv4 and ipv6 `all hostname`\n  // why do we need this check?\n  // hostname n/a for file protocol (example, when using electron, ionic)\n  // see: https://github.com/webpack/webpack-dev-server/pull/384\n\n\n  if ((hostname === '0.0.0.0' || hostname === '::') && loc.hostname && loc.protocol.indexOf('http') === 0) {\n    hostname = loc.hostname;\n  } // `hostname` can be empty when the script path is relative. In that case, specifying\n  // a protocol would result in an invalid URL.\n  // When https is used in the app, secure websockets are always necessary\n  // because the browser doesn't accept non-secure websockets.\n\n\n  if (hostname && hostname !== '127.0.0.1' && (loc.protocol === 'https:' || urlParts.hostname === '0.0.0.0')) {\n    protocol = loc.protocol;\n  } // all of these sock url params are optionally passed in through\n  // resourceQuery, so we need to fall back to the default if\n  // they are not provided\n\n\n  var sockHost = query.sockHost || hostname;\n  var sockPath = query.sockPath || '/sockjs-node';\n  var sockPort = query.sockPort || port;\n\n  if (sockPort === 'location') {\n    sockPort = loc.port;\n  }\n\n  return url.format({\n    protocol: protocol,\n    auth: auth,\n    hostname: sockHost,\n    port: sockPort,\n    // If sockPath is provided it'll be passed in via the resourceQuery as a\n    // query param so it has to be parsed out of the querystring in order for the\n    // client to open the socket to the correct location.\n    pathname: sockPath\n  });\n}\n\nmodule.exports = createSocketUrl;"],"mappings":"AAAA,aAGA,GAAIA,IAAG,CAAGC,OAAO,CAAC,KAAD,CAAjB,CAEA,GAAIC,uBAAsB,CAAGD,OAAO,4BAApC,CAEA,QAASE,gBAAT,CAAyBC,aAAzB,CAAwCC,eAAxC,CAAyD,CACvD,GAAIC,SAAJ,CAEA,GAAI,MAAOF,cAAP,GAAyB,QAAzB,EAAqCA,aAAa,GAAK,EAA3D,CAA+D,CAG7DE,QAAQ,CAAGN,GAAG,CAACO,KAAJ,CAAUH,aAAa,CACjCI,MADoB,CACb,CADa,EAEpBC,OAFoB,CAEZ,GAFY,CAEP,GAFO,CAAV,CAES,IAFT,CAAX,CAGD,CAND,IAMO,CAEL,GAAIC,WAAU,CAAGR,sBAAsB,EAAvC,CACAI,QAAQ,CAAGN,GAAG,CAACO,KAAJ,CAAUG,UAAU,EAAI,GAAxB,CAA6B,IAA7B,CAAmC,IAAnC,CAAX,CACD,CAGD,GAAI,MAAOL,gBAAP,GAA2B,QAA3B,EAAuCA,eAAe,GAAK,EAA/D,CAAmE,CACjEA,eAAe,CAAGL,GAAG,CAACO,KAAJ,CAAUF,eAAV,CAAlB,CACD,CAFD,IAEO,CACLA,eAAe,CAAGM,IAAI,CAACC,QAAvB,CACD,CAED,MAAOC,aAAY,CAACP,QAAD,CAAWD,eAAX,CAAnB,CACD,CAOD,QAASQ,aAAT,CAAsBP,QAAtB,CAAgCQ,GAAhC,CAAqC,CACnC,GAAIC,KAAI,CAAGT,QAAQ,CAACS,IAApB,CACIC,KAAK,CAAGV,QAAQ,CAACU,KADrB,CAEA,GAAIC,SAAQ,CAAGX,QAAQ,CAACW,QAAxB,CACIC,QAAQ,CAAGZ,QAAQ,CAACY,QADxB,CAEIC,IAAI,CAAGb,QAAQ,CAACa,IAFpB,CAIA,GAAI,CAACA,IAAD,EAASA,IAAI,GAAK,GAAtB,CAA2B,CACzBA,IAAI,CAAGL,GAAG,CAACK,IAAX,CACD,CAMD,GAAI,CAACF,QAAQ,GAAK,SAAb,EAA0BA,QAAQ,GAAK,IAAxC,GAAiDH,GAAG,CAACG,QAArD,EAAiEH,GAAG,CAACI,QAAJ,CAAaE,OAAb,CAAqB,MAArB,IAAiC,CAAtG,CAAyG,CACvGH,QAAQ,CAAGH,GAAG,CAACG,QAAf,CACD,CAMD,GAAIA,QAAQ,EAAIA,QAAQ,GAAK,WAAzB,GAAyCH,GAAG,CAACI,QAAJ,GAAiB,QAAjB,EAA6BZ,QAAQ,CAACW,QAAT,GAAsB,SAA5F,CAAJ,CAA4G,CAC1GC,QAAQ,CAAGJ,GAAG,CAACI,QAAf,CACD,CAKD,GAAIG,SAAQ,CAAGL,KAAK,CAACK,QAAN,EAAkBJ,QAAjC,CACA,GAAIK,SAAQ,CAAGN,KAAK,CAACM,QAAN,EAAkB,cAAjC,CACA,GAAIC,SAAQ,CAAGP,KAAK,CAACO,QAAN,EAAkBJ,IAAjC,CAEA,GAAII,QAAQ,GAAK,UAAjB,CAA6B,CAC3BA,QAAQ,CAAGT,GAAG,CAACK,IAAf,CACD,CAED,MAAOnB,IAAG,CAACwB,MAAJ,CAAW,CAChBN,QAAQ,CAAEA,QADM,CAEhBH,IAAI,CAAEA,IAFU,CAGhBE,QAAQ,CAAEI,QAHM,CAIhBF,IAAI,CAAEI,QAJU,CAQhBE,QAAQ,CAAEH,QARM,CAAX,CAAP,CAUD,CAEDI,MAAM,CAACC,OAAP,CAAiBxB,eAAjB"},"metadata":{},"sourceType":"script"}