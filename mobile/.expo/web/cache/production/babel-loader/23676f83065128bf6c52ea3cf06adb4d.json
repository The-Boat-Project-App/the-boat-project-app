{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useEffect,useState}from'react';import{NavigationContainer}from'@react-navigation/native';import View from\"react-native-web/dist/exports/View\";import HomeStackNavigator from\"./HomeStack\";import{setAccessToken,getRefreshToken}from'accessToken';import LottieView from'lottie-react-native';import{userDataVar}from\"../variables/userData\";import*as NavigationBar from'expo-navigation-bar';import{jsx as _jsx}from\"react/jsx-runtime\";var RootNavigator=function RootNavigator(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];NavigationBar.setBackgroundColorAsync('white');useEffect(function(){var refreshToken=function(){var _ref=_asyncToGenerator(function*(){var refreshToken=yield getRefreshToken();console.log('token before fetch',refreshToken);yield fetch(\"http://192.168.1.86:3333\"+\"/refresh_token_from_mobile\",{method:'POST',credentials:'include',headers:new Headers({Authorization:\"Bearer \"+refreshToken})}).then(function(){var _ref2=_asyncToGenerator(function*(x){var response=yield x.json();console.log('response',response);setAccessToken(response.accessToken,response.refreshToken);userDataVar({firstName:response.firstName,lastName:response.lastName,avatar:response.avatar});setLoading(false);});return function(_x){return _ref2.apply(this,arguments);};}());});return function refreshToken(){return _ref.apply(this,arguments);};}();refreshToken();},[]);if(loading){return _jsx(View,{className:\"flex-1 items-center justify-center\",children:_jsx(LottieView,{source:require(\"../assets/animations/loader.json\"),autoPlay:true,loop:true})});}return _jsx(NavigationContainer,{children:_jsx(HomeStackNavigator,{})});};export default RootNavigator;","map":{"version":3,"names":["React","useEffect","useState","NavigationContainer","HomeStackNavigator","setAccessToken","getRefreshToken","LottieView","userDataVar","NavigationBar","RootNavigator","loading","setLoading","setBackgroundColorAsync","refreshToken","console","log","fetch","method","credentials","headers","Headers","Authorization","then","x","response","json","accessToken","firstName","lastName","avatar","require"],"sources":["/Users/matthieu/Documents/boatproject/mobile/navigation/index.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { NavigationContainer } from '@react-navigation/native'\nimport { View, Text, ActionSheetIOS } from 'react-native'\nimport HomeStackNavigator from './HomeStack'\nimport { setAccessToken, getRefreshToken } from 'accessToken'\nimport LottieView from 'lottie-react-native'\nimport { userDataVar } from '../variables/userData'\nimport * as NavigationBar from 'expo-navigation-bar'\n\nconst RootNavigator = () => {\n  const [loading, setLoading] = useState(true)\n  NavigationBar.setBackgroundColorAsync('white')\n  useEffect(() => {\n    const refreshToken = async () => {\n      const refreshToken = await getRefreshToken()\n      console.log('token before fetch', refreshToken)\n      await fetch(`${process.env.API_URL}/refresh_token_from_mobile`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: new Headers({\n          Authorization: `Bearer ${refreshToken}`,\n        }),\n      }).then(async (x) => {\n        const response = await x.json()\n        console.log('response', response)\n        // console.log('accessToken', accessToken)\n        // console.log('refreshToken', refreshToken)\n\n        setAccessToken(response.accessToken, response.refreshToken)\n        userDataVar({\n          firstName: response.firstName,\n          lastName: response.lastName,\n          avatar: response.avatar,\n        })\n        setLoading(false)\n      })\n    }\n    refreshToken()\n  }, [])\n\n  if (loading) {\n    return (\n      <View className='flex-1 items-center justify-center'>\n        <LottieView source={require('../assets/animations/loader.json')} autoPlay loop />\n      </View>\n    )\n  }\n  return (\n    <NavigationContainer>\n      <HomeStackNavigator />\n    </NavigationContainer>\n  )\n}\n\nexport default RootNavigator\n"],"mappings":"wIAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,mBAAT,KAAoC,0BAApC,C,qDAEA,MAAOC,mBAAP,mBACA,OAASC,cAAT,CAAyBC,eAAzB,KAAgD,aAAhD,CACA,MAAOC,WAAP,KAAuB,qBAAvB,CACA,OAASC,WAAT,6BACA,MAAO,GAAKC,cAAZ,KAA+B,qBAA/B,C,2CAEA,GAAMC,cAAa,CAAG,QAAhBA,cAAgB,EAAM,CAC1B,cAA8BR,QAAQ,CAAC,IAAD,CAAtC,wCAAOS,OAAP,eAAgBC,UAAhB,eACAH,aAAa,CAACI,uBAAd,CAAsC,OAAtC,EACAZ,SAAS,CAAC,UAAM,CACd,GAAMa,aAAY,uCAAG,WAAY,CAC/B,GAAMA,aAAY,MAASR,gBAAe,EAA1C,CACAS,OAAO,CAACC,GAAR,CAAY,oBAAZ,CAAkCF,YAAlC,EACA,KAAMG,MAAK,yDAAqD,CAC9DC,MAAM,CAAE,MADsD,CAE9DC,WAAW,CAAE,SAFiD,CAG9DC,OAAO,CAAE,GAAIC,QAAJ,CAAY,CACnBC,aAAa,WAAYR,YADN,CAAZ,CAHqD,CAArD,CAAL,CAMHS,IANG,wCAME,UAAOC,CAAP,CAAa,CACnB,GAAMC,SAAQ,MAASD,EAAC,CAACE,IAAF,EAAvB,CACAX,OAAO,CAACC,GAAR,CAAY,UAAZ,CAAwBS,QAAxB,EAIApB,cAAc,CAACoB,QAAQ,CAACE,WAAV,CAAuBF,QAAQ,CAACX,YAAhC,CAAd,CACAN,WAAW,CAAC,CACVoB,SAAS,CAAEH,QAAQ,CAACG,SADV,CAEVC,QAAQ,CAAEJ,QAAQ,CAACI,QAFT,CAGVC,MAAM,CAAEL,QAAQ,CAACK,MAHP,CAAD,CAAX,CAKAlB,UAAU,CAAC,KAAD,CAAV,CACD,CAnBK,+DAAN,CAoBD,CAvBiB,wEAAlB,CAwBAE,YAAY,GACb,CA1BQ,CA0BN,EA1BM,CAAT,CA4BA,GAAIH,OAAJ,CAAa,CACX,MACE,MAAC,IAAD,EAAM,SAAS,CAAC,oCAAhB,UACE,KAAC,UAAD,EAAY,MAAM,CAAEoB,OAAO,oCAA3B,CAAiE,QAAQ,KAAzE,CAA0E,IAAI,KAA9E,EADF,EADF,CAKD,CACD,MACE,MAAC,mBAAD,WACE,KAAC,kBAAD,IADF,EADF,CAKD,CA3CD,CA6CA,cAAerB,cAAf"},"metadata":{},"sourceType":"module"}